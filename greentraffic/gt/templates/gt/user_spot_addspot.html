{% extends "gt/base.html" %}
{% load static %}
{% block title %}Green Traffic{% endblock %}

{% block head %}
<style>
  #map {
    height: 100%;
  }
</style>
{% endblock %}

{% block content %}
<body onload="initMap()">
    <div id="map"></div>
    <!-- <div id="map_canvas" style="width:100%;height:300px"></div> -->
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA5diRbD4Ex24SsS0_YISzQW5f19mckhf4&callback=initMap&v=weekly"
        defer
    ></script>
    <script>
        function initMap() {
            var target = document.getElementById('map'); //マップを表示する要素を指定
            var address = '{{ user.account.state }} {{ user.account.city }} {{ user.account.address }}'; //住所を指定
            var geocoder = new google.maps.Geocoder();  

            geocoder.geocode({ address: address }, function(results, status){
                if (status === 'OK' && results[0]){
            
                    console.log(results[0].geometry.location);
            
                    var map = new google.maps.Map(target, {  
                    center: results[0].geometry.location,
                    zoom: 18
                    });
            
                    var marker = new google.maps.Marker({
                    position: results[0].geometry.location,
                    map: map,
                    animation: google.maps.Animation.DROP
                    });
            
                }else{ 
                    //住所が存在しない場合の処理
                    alert('住所が正しくないか存在しません。');
                    target.style.display='none';
                }
            });
        }
    </script>
</body>
{% endblock content %}